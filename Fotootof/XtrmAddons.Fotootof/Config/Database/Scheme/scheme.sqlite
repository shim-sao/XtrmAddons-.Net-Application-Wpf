/** ********************************************************************
 * ACLACTIONS => Sections Actions | Albums Actions
 */
CREATE TABLE IF NOT EXISTS [AclActions] (
	[AclActionId] INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
	
	[Action] VARCHAR(64) NOT NULL DEFAULT '' NOT NULL,
	[Parameters] TEXT DEFAULT '' NOT NULL
);

REPLACE INTO [AclActions] (AclActionId, Action, Parameters)
VALUES
(1, 'section.add', ''),
(2, 'section.edit', ''),
(3, 'section.delete', ''),
(4, 'section.view', ''),
(5, 'album.add', ''),
(6, 'album.edit', ''),
(7, 'album.delete', ''),
(8, 'album.view', '');


/** ********************************************************************
 * ACLGROUPS => Users Groups
 */
CREATE TABLE IF NOT EXISTS [AclGroups] (
	[AclGroupId] INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,

	[Name] VARCHAR(64) NOT NULL DEFAULT '' NOT NULL,
	[Alias] VARCHAR(64) DEFAULT '' NOT NULL,

	[ParentId] INTEGER DEFAULT '0' NOT NULL,

	[IsDefault] BOOLEAN DEFAULT '0' NOT NULL,
	[Ordering] INTEGER DEFAULT '0' NOT NULL,

	[Comment] TEXT DEFAULT '' NOT NULL
);

REPLACE INTO [AclGroups] (AclGroupId, Name, Alias, ParentId, IsDefault, Ordering, Comment)
VALUES
(1, 'Administrateur', 'administrateur', 0, 0, 0, 'Groupe authorisés à gérer l''administration du serveur.'),
(2, 'Visiteurs', 'visiteurs', 0, 1, 0, 'Groupe authorisé à visiter la librairie d''images.');

CREATE TABLE IF NOT EXISTS [AclGroupsInAclActions] (
	[AclGroupId] INTEGER,
	[AclActionId] INTEGER
);


/** ********************************************************************
 *	ALBUMS
 */
CREATE TABLE IF NOT EXISTS [Albums] (
	[AlbumId] integer PRIMARY KEY AUTOINCREMENT NOT NULL,

	[Name] VARCHAR(64) DEFAULT '' NOT NULL,
	[Alias] VARCHAR(64) DEFAULT '' NOT NULL,
	[Description] TEXT DEFAULT '' NOT NULL,

	[Ordering] INTEGER DEFAULT '0' NOT NULL,

	[Created] TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,
	[Modified] TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,

	[DateStart] TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,
	[DateEnd] TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,

	[backgroundPictureId] INTEGER DEFAULT '0' NOT NULL,
	[previewPictureId] INTEGER DEFAULT '0' NOT NULL,
	[thumbnailPictureId] INTEGER DEFAULT '0' NOT NULL,

	[Comment] TEXT DEFAULT '' NOT NULL,
	[Parameters] TEXT DEFAULT '' NOT NULL
);

CREATE TABLE IF NOT EXISTS [AlbumsInSections] (
	[AlbumId] INTEGER,
	[SectionId] INTEGER,
	[Ordering] INTEGER DEFAULT '0' NOT NULL
);


/** ********************************************************************
 * INFORMATIONS
 */
CREATE TABLE IF NOT EXISTS [Infos] (
	[InfoId] INTEGER  PRIMARY KEY AUTOINCREMENT NOT NULL,
	[InfoTypeId] INTEGER DEFAULT '0' NOT NULL,

	[Name] VARCHAR(64) DEFAULT '' NOT NULL,
	[Alias] VARCHAR(64) DEFAULT '' NOT NULL,
	[Description] TEXT DEFAULT '' NOT NULL,

	[IsDefault] BOOLEAN DEFAULT '0' NOT NULL,
	[Ordering] INTEGER DEFAULT '0' NOT NULL
);

REPLACE INTO [Infos] (InfoId, InfoTypeId, Name, Alias, Description, IsDefault, Ordering)
VALUES
(1, 1, 'High', 'high', 'Defines High Quality pictures.', 1, 0),
(2, 1, 'Medium', 'medium', 'Defines Medium Quality pictures.', 0, 1),
(3, 1, 'Low', 'low', 'Defines Low Quality pictures.', 0, 2),
(4, 1, 'Various', 'various', 'Defines High Quality pictures.', 0, 3);

REPLACE INTO [Infos] (InfoId, InfoTypeId, Name, Alias, Description, IsDefault, Ordering)
VALUES
(5, 2, 'True Color', 'true-color', 'Defines true color pictures.', 0, 0),
(6, 2, 'Black White', 'black-white', 'Defines true color pictures.', 0, 1),
(7, 2, 'Various', 'various', 'Defines various color pictures.', 0, 2);

CREATE TABLE IF NOT EXISTS [InfosTypes] (
	[InfoTypeId] INTEGER  PRIMARY KEY AUTOINCREMENT NOT NULL,

	[Name] VARCHAR(64) DEFAULT '' NOT NULL,
	[Alias] VARCHAR(64) DEFAULT '' NOT NULL,
	[Description] TEXT DEFAULT '' NOT NULL,

	[IsDefault] BOOLEAN DEFAULT '0' NOT NULL,
	[Ordering] INTEGER DEFAULT '0' NOT NULL
);

REPLACE INTO [InfosTypes] (InfoTypeId, Name, Alias, Description, IsDefault, Ordering) VALUES (1, 'Quality', 'quality', 'Defines pictures  quality.', 0, 0);
REPLACE INTO [InfosTypes] (InfoTypeId, Name, Alias, Description, IsDefault, Ordering) VALUES (2, 'Color', 'color', 'Defines pictures color.', 0, 1);

CREATE TABLE IF NOT EXISTS [InfosInPictures] (
	[InfoId] INTEGER,
	[PictureId] INTEGER
);

CREATE TABLE IF NOT EXISTS [InfosInAlbums] (
	[InfoId] INTEGER,
	[AlbumId] INTEGER
);


/** ********************************************************************
 * PICTURES
 */
CREATE TABLE IF NOT EXISTS [Pictures] (
	[PictureId] INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,

	[Name] VARCHAR(64) DEFAULT '' NOT NULL,
	[Alias] VARCHAR(64) DEFAULT '' NOT NULL,
	[Description] TEXT DEFAULT '' NOT NULL,

	[IsDefault] BOOLEAN DEFAULT '0' NOT NULL,
	[Ordering] INTEGER DEFAULT '0' NOT NULL,

	[Captured] TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,
	[Created] TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,
	[Modified] TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,

	[OriginalPath] VARCHAR(256) NOT NULL DEFAULT '' NOT NULL,
	[OriginalWidth] INTEGER DEFAULT '0' NOT NULL,
	[OriginalHeight] INTEGER DEFAULT '0' NOT NULL,
	[OriginalLength] INTEGER DEFAULT '0' NOT NULL,

	[PicturePath] VARCHAR(256) NOT NULL DEFAULT '' NOT NULL,
	[PictureWidth] INTEGER DEFAULT '0' NOT NULL,
	[PictureHeight] INTEGER DEFAULT '0' NOT NULL,
	[PictureLength] INTEGER DEFAULT '0' NOT NULL,

	[ThumbnailPath] VARCHAR(256) DEFAULT '' NOT NULL,
	[ThumbnailWidth] INTEGER DEFAULT '0' NOT NULL,
	[ThumbnailHeight] INTEGER DEFAULT '0' NOT NULL,
	[ThumbnailLength] INTEGER DEFAULT '0' NOT NULL,

	[Comment] TEXT DEFAULT '' NOT NULL
);

CREATE TABLE IF NOT EXISTS [PicturesInAlbums] (
	[PictureId] INTEGER,
	[AlbumId] INTEGER,
	[Ordering] INTEGER DEFAULT '0' NOT NULL
);


/** ********************************************************************
 * SECTIONS
 */
CREATE TABLE IF NOT EXISTS [Sections] (
	[SectionId] INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,

	[Name] VARCHAR(64)  NOT NULL DEFAULT '' NOT NULL,
	[Alias] VARCHAR(64) DEFAULT '' NOT NULL,
	[Description] TEXT DEFAULT '' NOT NULL,

	[IsDefault] BOOLEAN DEFAULT '0' NOT NULL,
	[Ordering] INTEGER DEFAULT '0' NOT NULL,

	[backgroundPictureId] INTEGER DEFAULT '0' NOT NULL,
	[previewPictureId] INTEGER DEFAULT '0' NOT NULL,
	[thumbnailPictureId] INTEGER DEFAULT '0' NOT NULL,

	[Comment] TEXT DEFAULT '' NOT NULL,
	[Parameters] TEXT DEFAULT '' NOT NULL
);

CREATE TABLE IF NOT EXISTS [SectionsInAclGroups] (
	[SectionId] INTEGER,
	[AclGroupId] INTEGER
);


/** ********************************************************************
 * TAGS
 */
CREATE TABLE IF NOT EXISTS [Tags] (
	[TagId] INTEGER  PRIMARY KEY AUTOINCREMENT NOT NULL,

	[Name] VARCHAR(64) DEFAULT '' NOT NULL,
	[Alias] VARCHAR(64) DEFAULT '' NOT NULL,
	[Description] TEXT DEFAULT '' NOT NULL,

	[IsDefault] BOOLEAN DEFAULT '0' NOT NULL,
	[Ordering] INTEGER DEFAULT '0' NOT NULL,

	[Created] TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,
	[Modified] TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,

	[Comment] TEXT DEFAULT '' NOT NULL
);

CREATE TABLE IF NOT EXISTS [TagsInAlbums] (
	[TagId] INTEGER,
	[AlbumId] INTEGER
	
);

CREATE TABLE IF NOT EXISTS [TagsInPictures] (
	[TagId] INTEGER,
	[PictureId] INTEGER
	
);


/** ********************************************************************
 * USERS
 */
CREATE TABLE IF NOT EXISTS [Users] (
	[UserId] INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL ,

	[Name] VARCHAR(64) NOT NULL DEFAULT '' NOT NULL ,
	[Password] VARCHAR(64) NOT NULL DEFAULT '' NOT NULL,
	[email] VARCHAR(128) NOT NULL DEFAULT '' NOT NULL,
	[server] VARCHAR(16) NOT NULL DEFAULT 'localhost' NOT NULL,

	[Created] TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,
	[Modified] TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL
);

CREATE TABLE IF NOT EXISTS [UsersInAclGroups] (
	[UserId] INTEGER,
	[AclGroupId] INTEGER
	
);


/** ********************************************************************
 * VERSIONS
 */
CREATE TABLE IF NOT EXISTS `Versions` (
	`VersionId`	INTEGER NOT NULL,
	`AssemblyVersionMin`	TEXT NOT NULL DEFAULT '',
	`AssemblyVersionMax`	TEXT NOT NULL DEFAULT '',
	`Comment`	TEXT NOT NULL DEFAULT '',
	PRIMARY KEY(`VersionId`)
);

REPLACE INTO [Versions]
(VersionId, AssemblyVersionMin, AssemblyVersionMax, Comment)
VALUES
(1, '1.0.18123.2149', '', 'Database first create.'),
(2, '1.0.18134.1044', '', 'Database Albums shema changed. Albums pictures are associated by Primary Keys.');

